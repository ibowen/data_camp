/*******reference: https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-HiveHBaseIntegrationnotes: be careful of the key*****/add jar hdfs://master1.internal.datalaus.net:8020/user/1604bowen/lib/json-serde-1.3.8-SNAPSHOT-jar-with-dependencies.jar;-- businessDROP TABLE yelp_business_fromHive_bowen;CREATE TABLE yelp_business_fromHive_bowen(business_id STRING,type STRING,name STRING,full_address STRING,city STRING,state STRING,latitude DOUBLE,longitude DOUBLE,stars DOUBLE,review_count INT,open BOOLEAN,categories array<STRING>,neighborhoods ARRAY<STRING>) STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,profile:type,profile:name,profile:full_address,profile:city,profile:state,profile:latitude,profile:longitude,review:stars,review:review_count,profile:open,profile:categories,profile:neighborhoods")TBLPROPERTIES ("hbase.table.name" = "yelp_business_fromHive_bowen", "hbase.mapred.output.outputtable" = "yelp_business_fromHive_bowen");INSERT OVERWRITE TABLE yelp_business_fromHive_bowen SELECT * FROM yelp_train_business_json;scan 'yelp_business_fromHive_bowen', {'LIMIT' => 5}-- userDROP TABLE yelp_user_fromHive_bowen;CREATE TABLE yelp_user_fromHive_bowen (user_id STRING,type STRING,name STRING,review_count INT,average_stars FLOAT,votes MAP<STRING, STRING>)STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,user:type,user:name,review:review_count,review:average_stars,votes:*")TBLPROPERTIES ("hbase.table.name" = "yelp_user_fromHive_bowen", "hbase.mapred.output.outputtable" = "yelp_user_fromHive_bowen");INSERT OVERWRITE TABLE yelp_user_fromHive_bowen SELECT * FROM yelp_train_user_json;scan 'yelp_user_fromHive_bowen', {'LIMIT' => 5}-- reviewDROP TABLE yelp_review_fromHive_bowen;CREATE TABLE yelp_review_fromHive_bowen (user_id STRING,votes MAP<STRING, INT>,review_id STRING,stars STRING,`date` STRING,text STRING,type STRING,business_id STRING)STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,votes:*,review:review_id,review:stars,review:`date`,review:text,review:type,review:business_id")TBLPROPERTIES ("hbase.table.name" = "yelp_review_fromHive_bowen", "hbase.mapred.output.outputtable" = "yelp_review_fromHive_bowen");INSERT OVERWRITE TABLE yelp_review_fromHive_bowen SELECT * FROM yelp_train_review_json;scan 'yelp_review_fromHive_bowen', {'LIMIT' => 5}-- checkinDROP TABLE yelp_checkin_fromHive_bowen;CREATE TABLE yelp_checkin_fromHive_bowen (business_id STRING,type STRING,checkin_info MAP<STRING, INT>)STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,business:type,checkin_info:*")TBLPROPERTIES ("hbase.table.name" = "yelp_checkin_fromHive_bowen", "hbase.mapred.output.outputtable" = "yelp_checkin_fromHive_bowen");INSERT OVERWRITE TABLE yelp_checkin_fromHive_bowen SELECT * FROM yelp_train_checkin_json;scan 'yelp_checkin_fromHive_bowen', {'LIMIT' => 5}